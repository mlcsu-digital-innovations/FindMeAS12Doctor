<app-navbar></app-navbar>

<ion-content>
  <ion-grid>
    <ion-row>
      <ion-label class="page-title">
        AMHP Assessment
      </ion-label>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label>
          Last Updated: {{assessmentLastUpdated | date: "dd/MM/yyyy HH:mm:ss"}}
        </ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        &nbsp;
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>        
        Referral Id: <strong>{{assessmentView?.referralId}}</strong>       
      </ion-col>
    </ion-row>

    <ion-row *ngIf="assessmentView?.canUpdateOutcome">
      <ion-col>      
        Patient Id: <strong>{{assessmentView?.patientIdentifier}}</strong>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>       
        {{assessmentView?.dateTime | date: "d MMMM yyyy H:mm"}}       
      </ion-col>
    </ion-row>

    <ion-row *ngIf="assessmentView?.canUpdateOutcome">
      <ion-col>       
        Assessment Speciality:
        <ion-text class="ion-text-wrap">
          <strong>{{assessmentView?.specialityName}}</strong>
        </ion-text>               
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>        
          {{assessmentView?.address1}}
          <br *ngIf="assessmentView?.address1?.length > 0" />
          {{assessmentView?.address2}}
          <br *ngIf="assessmentView?.address2?.length > 0" />
          {{assessmentView?.address3}}
          <br *ngIf="assessmentView?.address3?.length > 0" />             
          {{assessmentView?.address4}}
          <br *ngIf="assessmentView?.address4?.length > 0" />
          <strong>{{assessmentView?.postcode}}</strong>      
      </ion-col>
    </ion-row>

    <ion-row *ngIf="!displayDoctors">
      <ion-col>
        <strong>No doctors allocated or selected</strong>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="displayDoctors">
      <ion-col>
        &nbsp;
      </ion-col>
    </ion-row>

    <ion-row *ngIf="displayDoctors">
      <ion-label offset="1">
        <strong>Allocated doctors</strong>
      </ion-label>
    </ion-row>

    <ion-row *ngIf="displayDoctors">
      <ion-col>    
        <ion-text *ngFor="let doctor of assessmentView?.doctorsAllocated">         
          {{doctor.displayName}}
          <ion-icon class="outstanding" size="small" name="help-circle" 
            *ngIf="!doctor.hasResponded">
          </ion-icon>
          <br />
        </ion-text>   
        <ion-text *ngIf="!assessmentView?.doctorsAllocated">none</ion-text>                
      </ion-col>
    </ion-row>

    <ion-row *ngIf="displayDoctors && !assessmentView?.canUpdateOutcome">
      <ion-col>
        &nbsp;
      </ion-col>
    </ion-row>

    <ion-row *ngIf="displayDoctors && !assessmentView?.canUpdateOutcome">
      <ion-label offset="1">
        <strong>Selected doctors</strong>
      </ion-label>
    </ion-row>

    <ion-row *ngIf="displayDoctors && !assessmentView?.canUpdateOutcome">
      <ion-col>                
        <ion-text *ngFor="let doctor of assessmentView?.doctorsSelected">          
          {{doctor.displayName}} {{doctor.distance}} miles
          <ion-icon class="outstanding" size="small" name="help-circle" 
            *ngIf="!doctor.hasResponded">
          </ion-icon>
          <br />
        </ion-text>   
        <ion-text *ngIf="!assessmentView?.doctorsSelected">none</ion-text>                
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        &nbsp;
      </ion-col>
    </ion-row>

    <ion-row *ngIf="assessmentView?.canUpdateOutcome">
      <ion-col>        
        {{assessmentView?.meetingArrangementComment}}        
      </ion-col>
    </ion-row>    

    <ion-row>
      <ion-col>
        <ion-button 
          *ngIf="assessmentView?.canUpdateOutcome             
            && assessmentView?.isSuccessful===null             
            && assessmentView?.doctorsAllocated?.length > 0"
          expand="block" 
          color="warning" 
          (click)="this.updateAssessment()">
          Update status
        </ion-button>
      </ion-col>
    </ion-row>

  </ion-grid>
</ion-content>